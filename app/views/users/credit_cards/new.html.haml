.row
  .col-md-9.col-sm-12.col-xs-12
    %section
      .panel
        .panel-heading.panel-heading-border.clearfix
          %h4.panel-title Mechanic
        .panel-body
          .row
            .profile-border
              = render 'shared/mechanic/avatar', mechanic: @mechanic
            %div
              %h4= @mechanic.full_name
              - if @mechanic.years_as_a_mechanic
                #{pluralize @mechanic.years_as_a_mechanic, 'year'} of experience
              %br
              %ul.text-info
                %li
                  %i.icon-ok
                  #{@job.scheduled_at.to_s(:date)}
                %li
                  %i.icon-ok
                  #{@job.scheduled_at.to_s(:time)}

    .panel.panel-default.panel-rounded
      .panel-heading
        %h4.panel-title Payment Process
      .panel-body
        - if @error
          .alert.alert-danger
            %p.text-center
              %b An error occured verifying your credit card
        - else
          .alert.alert-info
            %p.text-center
              Providing a credit card holds your spot with the mechanic, much like reserving a room at a hotel.
              %br
              %b No money will be billed until you confirm your quote and after your job is complete.
        .col-md-5.col-md-offset-3
          .col-md-12.text-center
            = image_tag asset_url('payment-img.jpg'), class: 'payment-img img-responsive'
          = simple_form_for [:users, @job, @job.build_credit_card], url: users_job_credit_card_path(@job) do
            -#
              %input.hidden.add-promo#add-promo{type: 'checkbox'}
              %label.add-promo-label.lazure{for: 'add-promo'} Add Promo Code
              .form-group.promo-group
                %label Enter code (if applicable) then click update:
                .col-md-8.col-sm-8.col-xs-12
                  %input.form-control.vertical-align{type: 'text'}
                = link_to 'Update', '#', class: 'btn btn-default col-md-4 col-sm-4 col-xs-12'
            .form-group
              %label Name on the credit card
              %input.col-md-12.form-control{type: 'text', autocomplete: 'off', 'data-encrypted-name' => 'credit_card[cardholder_name]'}
            .form-group
              %label Credit Card Number
              %input.col-md-12.form-control{type: 'text', autocomplete: 'off', 'data-encrypted-name' => 'credit_card[number]'}
            .form-group
              %label Expiration Date
              %input.col-md-12.form-control{type: 'text', placeholder: 'mm/yy', autocomplete: 'off', 'data-encrypted-name' => 'credit_card[expiration_date]'}
            .form-group
              %label CCV
              %input.col-md-12.form-control{type: 'text', autocomplete: 'off', 'data-encrypted-name' => 'credit_card[cvv]'}
            %label
              I have read and agreed to the
              = link_to 'terms of use', page_path(:terms_of_use), target: '_blank'
            %div
              %button.btn.btn-info{type: 'submit'} Send Me a Quote
= javascript_include_tag 'https://js.braintreegateway.com/v1/braintree.js'
:coffee
  braintree = Braintree.create('MIIBCgKCAQEA0iDZGZeMW3w4c1dljlEghWBskAEQUiwnzi5ilc4Rk6oLtV0HKMJEm1ARXnopAYnaQh7FIOotLXcsJGAZf1Dxhe/lR6dJmSCFh8BLBLjNs1k1jUhhnZJHsh+SNhBjqJ/gmqbnrgY0mEvSSfVOcPN4jiGesMTijAeWaREM5t7SmivtdmMQ3hqYS41cMWeGYXi74B/uObS9uFq5A6DQUaIjfFkpEi504f2njPY9L76ZsRqKr5UZwcR6BLhUpvAHeJvvJs0NkX2TGdzsS1KWNLYN1mSmW1ja7xGDXb53dvXFdkfes2eB8tzAcjYojv+9a8SfgGC4/9kMdR21/axEhG7NTwIDAQAB')
  braintree.onSubmitEncryptForm('new_credit_card')
